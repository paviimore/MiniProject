

gcloud config set compute/zone europe-west2-b
export PROJECT_ID="$(gcloud config get-value project -q)"


docker pull cassandra:latest
docker run --name cassandra-test -d cassandra:latest

docker cp countrycodes.csv cassandra:/home/countrycodes.csv

gcloud container clusters create cassandra --num-nodes=3 --machine-type "n1-standard-2"


wget -O cassandra-peer-service.yml http://tinyurl.com/yyxnephy
wget -O cassandra-service.yml http://tinyurl.com/y65czz8e
wget -O cassandra-replication-controller.yml http://tinyurl.com/y2crfsl8


kubectl create -f cassandra-peer-service.yml
kubectl create -f cassandra-service.yml
kubectl create -f cassandra-replication-controller.yml


kubectl get pods -l name=cassandra

kubectl scale rc cassandra --replicas=3
kubectl exec -it cassandra-24bgm -- nodetool status
kubectl cp countrycodes.csv cassandra-24bgm:/countrycodes.csv
kubectl exec -it cassandra-24bgm cqlsh

CREATE KEYSPACE forex WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor' : 2};
CREATE TABLE forex.exchange (Country text PRIMARY KEY, CountryCode text, Currency text, Code text);
COPY forex.exchange(Country, CountryCode, Currency, Code) FROM 'countrycodes.csv' WITH DELIMITER=',' AND HEADER=TRUE;
10.12.2.11



docker build -t gcr.io/${PROJECT_ID}/forex-app:v1 .

docker push gcr.io/${PROJECT_ID}/forex-app:v1

kubectl run forex-app --image=gcr.io/${PROJECT_ID}/forex-app:v1 --port 8080

kubectl expose deployment forex-app --type=LoadBalancer --port 80 --target-port 8080

kubectl get services


kubectl delete --all replicationcontroller
kubectl delete --all services
gcloud container clusters delete cassandra
gcloud container clusters resize cassandra --size=0

gcloud container clusters list
